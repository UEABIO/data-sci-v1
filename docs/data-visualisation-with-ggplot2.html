<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Data visualisation with ggplot2 | 5023Y</title>
<meta name="author" content="Philip T. Leftwich">
<meta name="description" content="6.1 Intro to grammar The ggplot2 package is widely used and valued for its simple, consistent approach to making data visuals. The 'grammar of graphics' relates to the different components of a...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 6 Data visualisation with ggplot2 | 5023Y">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ueabio.github.io/data-sci/data-visualisation-with-ggplot2.html">
<meta property="og:image" content="https://ueabio.github.io/data-sci/images/logos/twitter_card.png">
<meta property="og:description" content="6.1 Intro to grammar The ggplot2 package is widely used and valued for its simple, consistent approach to making data visuals. The 'grammar of graphics' relates to the different components of a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Data visualisation with ggplot2 | 5023Y">
<meta name="twitter:description" content="6.1 Intro to grammar The ggplot2 package is widely used and valued for its simple, consistent approach to making data visuals. The 'grammar of graphics' relates to the different components of a...">
<meta name="twitter:image" content="https://ueabio.github.io/data-sci/images/logos/twitter_card.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.13/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/font-awesome-5.13.0/js/script.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script language="javascript"> 
        function toggle(id) {
            var ele = document.getElementById("toggleText" + id);
            var text = document.getElementById("displayText" + id);
            var buttonText = text.innerHTML.replace("Show ", "");
            buttonText = buttonText.replace("Hide ", "");
            if(ele.style.display == "block") {
                ele.style.display = "none";
                text.innerHTML = "Show " + buttonText;
            } else {
                ele.style.display = "block";
                text.innerHTML = "Hide " + buttonText;
            }
        } 
    </script><script language="javascript">
        function openCode(evt, codeName, id) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent" + id);
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks" + id);
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(codeName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script><script language="javascript">
        function hide(id){
            document.getElementById(id).style.display = "none";
        }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Data Science for Biologists">5023Y</a>:
        <small class="text-muted">Data Science for Biologists</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li class="book-part">Get Started in R</li>
<li><a class="" href="introduction-to-r-and-rstudio.html"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="" href="r-basics.html"><span class="header-section-number">2</span> R Basics</a></li>
<li class="book-part">Exploring Data</li>
<li><a class="" href="loading-data.html"><span class="header-section-number">3</span> Loading data</a></li>
<li><a class="" href="data-wrangling-part-one.html"><span class="header-section-number">4</span> Data wrangling part one</a></li>
<li><a class="" href="data-wrangling-part-two.html"><span class="header-section-number">5</span> Data wrangling part two</a></li>
<li><a class="active" href="data-visualisation-with-ggplot2.html"><span class="header-section-number">6</span> Data visualisation with ggplot2</a></li>
<li class="book-part">Literate Programming and Reproducibility</li>
<li><a class="" href="markdown.html"><span class="header-section-number">7</span> Markdown</a></li>
<li><a class="" href="github.html"><span class="header-section-number">8</span> Github</a></li>
<li class="book-part">R Programming</li>
<li><a class="" href="functions-1.html"><span class="header-section-number">9</span> Functions</a></li>
<li class="book-part">Advanced Data Insights</li>
<li><a class="" href="data-insights-part-one.html"><span class="header-section-number">10</span> Data Insights part one</a></li>
<li><a class="" href="data-insights-part-two.html"><span class="header-section-number">11</span> Data insights part two</a></li>
<li class="book-part">Statistics</li>
<li><a class="" href="introduction-to-statistics.html"><span class="header-section-number">12</span> Introduction to statistics</a></li>
<li><a class="" href="introduction-to-linear-models.html"><span class="header-section-number">13</span> Introduction to Linear Models</a></li>
<li><a class="" href="testing.html"><span class="header-section-number">14</span> Testing</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">15</span> Regression</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">16</span> ANOVA</a></li>
<li><a class="" href="multivariate-linear-models.html"><span class="header-section-number">17</span> Multivariate linear models</a></li>
<li><a class="" href="complex-models.html"><span class="header-section-number">18</span> Complex models</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">19</span> Generalized Linear Models</a></li>
<li class="book-part">Advanced topics</li>
<li><a class="" href="mixed-models.html"><span class="header-section-number">20</span> Mixed models</a></li>
<li><a class="" href="generalised-additive-models.html"><span class="header-section-number">21</span> Generalised Additive Models</a></li>
<li><a class="" href="survival-models.html"><span class="header-section-number">22</span> Survival models</a></li>
<li><a class="" href="unsupervised-machine-learning.html"><span class="header-section-number">23</span> Unsupervised Machine Learning</a></li>
<li><a class="" href="power-analysis.html"><span class="header-section-number">24</span> Power analysis</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">25</span> Iteration</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="updating-r-rstudio-and-packages.html"><span class="header-section-number">B</span> Updating R, RStudio, and packages</a></li>
<li><a class="" href="exporting-files-from-the-server.html"><span class="header-section-number">C</span> Exporting files from the server</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">D</span> Symbols</a></li>
<li><a class="" href="baser.html"><span class="header-section-number">E</span> Base R vs. Tidyverse</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/UEABIO/data-sci-v1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-visualisation-with-ggplot2" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Data visualisation with ggplot2<a class="anchor" aria-label="anchor" href="#data-visualisation-with-ggplot2"><i class="fas fa-link"></i></a>
</h1>
<div id="intro-to-grammar" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Intro to grammar<a class="anchor" aria-label="anchor" href="#intro-to-grammar"><i class="fas fa-link"></i></a>
</h2>
<p>The ggplot2 package is widely used and valued for its simple, consistent approach to making data visuals.</p>
<p>The 'grammar of graphics' relates to the different components of a plot that function like different parts of linguistic grammar. For example, all plots require axes, so the x and y axes form one part of the ‘language’ of a plot. Similarly, all plots have data represented between the axes, often as points, lines or bars. The visual way that the data is represented forms another component of the grammar of graphics. Furthermore, the colour, shape or size of points and lines can be used to encode additional information in the plot. This information is usually clarified in a key, or legend, which can also be considered part of this ‘grammar’.</p>
<p>The philosophy of ggplot is much better explained by the package author, Hadley Wickham (<span class="citation"><a href="references.html#ref-R-ggplot2" role="doc-biblioref">Wickham et al.</a> (<a href="references.html#ref-R-ggplot2" role="doc-biblioref">2022</a>)</span>). For now, we just need to be aware that ggplots are constructed by specifying the different components that we want to display, based on underlying information in a data frame.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ambitious-figure"></span>
<img src="images/ambitious.png" alt="An example of what we can produce in ggplot" width="100%"><p class="caption">
Figure 6.1: An example of what we can produce in ggplot
</p>
</div>
</div>
<div id="before-we-start" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Before we start<a class="anchor" aria-label="anchor" href="#before-we-start"><i class="fas fa-link"></i></a>
</h2>
<p>You should have a workspace ready to work with the Palmer penguins data. Load this workspace now.</p>
<p>Think about some basic checks before you start your work today.</p>
<div id="checklist-2" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Checklist<a class="anchor" aria-label="anchor" href="#checklist-2"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Are there objects already in your Environment pane? <a href="r-basics.html#global-options">There shouldn't be</a>, if there are use <code><a href="https://rdrr.io/r/base/rm.html">rm(list=ls())</a></code>
</li>
</ul>
<div class="try">
<p>
Today we are going to make a NEW R script in the same project space as we have previously been working. This is part of organising our workspace so that our analysis workflow is <a href="loading-data.html#activity-1-organising-our-workspace">well documented and easy to follow</a>
</p>
</div>
<ul>
<li><p>Open a <strong>new</strong> R script - we are moving on from data wrangling to data visualisation</p></li>
<li><p>Save this file <strong>in the scripts folder</strong> and call it <code>02_visualisation_penguins.R</code></p></li>
<li><p>Add the following to your script and run it:</p></li>
</ul>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># LOAD R OBJECTS AND FUNCTIONS ----</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"scripts/01_import_penguins_data.R"</span><span class="op">)</span>
<span class="co"># import tidied penguins data and functions</span>
<span class="co">#__________________________----</span></code></pre></div>
<ul>
<li>You should find your Environment fills up with objects from script 1</li>
</ul>
<div class="info">
<p>
The <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> function is a very handy way of allowing you to have different scripts for different parts of your R project, but allow access to objects built elsewhere. In this way we are building our analysis in stages.
</p>
</div>
<div class="warning">
<p>
The above command will ONLY work if you remembered to save and name your script exactly as above AND put that script inside a subfolder called scripts.
</p>
<p>
Does your project look like the one below?
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="images/project_penguin.png" alt="My neat project layout" width="100%"><p class="caption">
Figure 6.2: My neat project layout
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="images/r_script.png" alt="If you have sucessfully saved 02_visualisation_penguins.R it should be visible here too " width="100%"><p class="caption">
Figure 6.3: If you have sucessfully saved 02_visualisation_penguins.R it should be visible here too
</p>
</div>
</div>
<div id="what-if-source-isnt-working" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> What if source isn't working?<a class="anchor" aria-label="anchor" href="#what-if-source-isnt-working"><i class="fas fa-link"></i></a>
</h3>
<p>If source isn't working, or you can't figure out your project set-up you can complete this worksheet if you put the following commands at the top of your script <em>instead</em> of <code><a href="https://rdrr.io/r/base/source.html">source("scripts/01_import_penguins_data.R")</a></code></p>
<div class="webex-solution">
<button>
Script adjustment
</button>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#___________________________----</span>
<span class="co"># SET UP ----</span>
<span class="co">## An analysis of the bill dimensions of male and female Adelie, Gentoo and Chinstrap penguins ----</span>

<span class="co">### Data first published in  Gorman, KB, TD Williams, and WR Fraser. 2014. “Ecological Sexual Dimorphism and Environmental Variability Within a Community of Antarctic Penguins (Genus Pygoscelis).” PLos One 9 (3): e90081. https://doi.org/10.1371/journal.pone.0090081. ----</span>--
<span class="co">#__________________________----</span>

<span class="co"># PACKAGES ----</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># tidy data packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span> <span class="co"># cleans variable names</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span> <span class="co"># make sure dates are processed properly</span>
<span class="co">#__________________________----</span>

<span class="co"># IMPORT DATA ----</span>
<span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span> <span class="op">(</span><span class="st">"data/penguins_raw.csv"</span><span class="op">)</span>

<span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> <span class="co"># clean variable names</span>
<span class="co">#__________________________----</span></code></pre></div>
</div>
</div>
</div>
<div id="building-a-plot" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Building a plot<a class="anchor" aria-label="anchor" href="#building-a-plot"><i class="fas fa-link"></i></a>
</h2>
<p>To start building the plot We are going to use the penguin data we have been working with previously. First we must specify the data frame that contains the relevant data for our plot. We can do this in two ways:</p>
<ol style="list-style-type: decimal">
<li>Here we are ‘sending the penguins data set into the ggplot function’:</li>
</ol>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Building a ggplot step by step ----</span>
<span class="co">## Render a plot background ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Here we are specifying the dataframe <em>within</em> the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function</li>
</ol>
<p>The output is identical</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="info">
<p>
Running this command will produce an empty grey panel. This is because we need to specify how different columns of the data frame should be represented in the plot.
</p>
</div>
<div id="aesthetics---aes" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Aesthetics - <code>aes()</code><a class="anchor" aria-label="anchor" href="#aesthetics---aes"><i class="fas fa-link"></i></a>
</h3>
<p>We can call in different columns of data from any dataset based on their column names. Column names are given as ‘aesthetic’ elements to the ggplot function, and are wrapped in the aes() function.</p>
<p>Because we want a scatter plot, each point will have an x and a y coordinate. We want the x axis to represent flipper length ( x = flipper_length_mm ), and the y axis to represent the body mass ( y = body_mass_g ).</p>
<p>We give these specifications separated by a comma. Quotes are not required when giving variables within <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<div class="info">
<p>
Those interested in why quotes aren’t required can read about <a href="https://edwinth.github.io/blog/nse/">non-standard evaluation</a>.
</p>
</div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Set axes ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>So far we have the grid lines for our x and y axis. <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> knows the variables required for the plot, and thus the scale, but has no information about how to display the data points.</p>
</div>
</div>
<div id="geometric-representations---geom" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Geometric representations - geom()<a class="anchor" aria-label="anchor" href="#geometric-representations---geom"><i class="fas fa-link"></i></a>
</h2>
<p>Given we want a scatter plot, we need to specify that the geometric representation of the data will be in point form, using geom_point(). <a href="https://ggplot2.tidyverse.org/reference/#geoms">There are many geometric object types</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:img-objects-enviro"></span>
<img src="images/geoms.png" alt="geom shapes" width="100%"><p class="caption">
Figure 2.1: geom shapes
</p>
</div>
<p>Here we are adding a layer (hence the + sign) of points to the plot. We can think of this as similar to e.g. Adobe Photoshop which uses layers of images that can be reordered and modified individually. Because we add to plots layer by layer <strong>the order</strong> of your geoms may be important for your final aesthetic design.</p>
<p>For ggplot, each layer will be added over the plot according to its position in the code. Below I first show the full breakdown of the components in a layer. Each layer requires information on</p>
<ul>
<li>data</li>
<li>aesthetics</li>
<li>geometric type</li>
<li>any summary of the data</li>
<li>position</li>
</ul>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Add a geom ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/layer.html">layer</a></span><span class="op">(</span>                <span class="co"># layer inherits data and aesthetic arguments from previous</span>
    geom<span class="op">=</span><span class="st">"point"</span>,       <span class="co"># draw point objects</span>
    stat<span class="op">=</span><span class="st">"identity"</span>,    <span class="co"># each individual data point gets a geom (no summaries)</span>
    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_identity.html">position_identity</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># data points are not moved in any way e.g. we could specify jitter or dodge if we want to avoid busy overlapping data</span></code></pre></div>
<p>This is quite a complicate way to write new layers - and it is more usual to see a simpler more compact approach</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># geom_point function will always draw points, and unless specified otherwise the arguments for position and stat are both "identity".</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Now we have the scatter plot! Each row (except for two rows of missing data) in the penguins data set now has an x coordinate, a y coordinate, and a designated geometric representation (point).</p>
<p>From this we can see that smaller penguins tend to have smaller flipper lengths.</p>
<div id="and" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> %&gt;% and +<a class="anchor" aria-label="anchor" href="#and"><i class="fas fa-link"></i></a>
</h3>
<p>ggplot2, an early component of the tidyverse package, was written before the pipe was introduced. The + sign in ggplot2 functions in a similar way to the pipe in other functions in the tidyverse: by allowing code to be written from left to right.</p>
</div>
<div id="colour" class="section level3" number="6.4.2">
<h3>
<span class="header-section-number">6.4.2</span> Colour<a class="anchor" aria-label="anchor" href="#colour"><i class="fas fa-link"></i></a>
</h3>
<p>The colors of lines and points can be set directly using <code>colour="red"</code>, replacing “red” with a color name. The colors of filled objects, like bars, can be set using <code>fill="red"</code>.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>However the current plot could be more informative if colour was used to convey information about the species of each penguin.</p>
<p>In order to achieve this we need to use <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> again, and make the colour conditional upon a variable.</p>
<p>Here, the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> function containing the relevant column name, is given within the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function.</p>
<div class="warning">
<p>
A common mistake is to get confused about when to use (or not use) <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>
</p>
<p>
If specifying a fixed aesthetic e.g. red for everything it DOES NOT go inside <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> instead specify e.g. colour = "red" or shape =21.
</p>
<p>
If you wish to modify an aethetic according to a variable in your data THEN it DOES go inside <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> e.g. <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes(colour = species)</a></code>
</p>
</div>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="info">
<p>
You may (or may not) have noticed that the grammar of ggplot (and tidyverse in general) accepts British/Americanization for spelling!!!
</p>
</div>
<p>With data visualisations we can start to gain insights into our data very quickly, we can see that the Gentoo penguins tend to be both larger and have longer flippers</p>
<div class="info">
<p>
Add carriage returns (new lines) after each %&gt;% or + symbols.
</p>
<p>
In most cases, R is blind to white space and new lines, so this is simply to make our code more readable, and allow us to add readable comments.
</p>
</div>
</div>
<div id="more-layers" class="section level3" number="6.4.3">
<h3>
<span class="header-section-number">6.4.3</span> More layers<a class="anchor" aria-label="anchor" href="#more-layers"><i class="fas fa-link"></i></a>
</h3>
<p>We can see the relationship between body size and flipper length. But what if we want to model this relationship with a trend line? We can add another ‘layer’ to this plot, using a different geometric representation of the data. In this case a trend line, which is in fact a summary of the data rather than a representation of each point.</p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> function draws a trend line through the data. The default behaviour is to draw a local regression line (curve) through the points, however these can be hard to interpret. We want to add a straight line based on a linear model (‘lm’) of the relationship between x and y.</p>
<p>This is our <strong>first</strong> encounter with linear models in this course, but we will learn a lot more about them later on.</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Add a second geom ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    <span class="co">#add another layer of data representation.</span>
              se<span class="op">=</span><span class="cn">FALSE</span>,
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="co"># note layers inherit information from the top ggplot() function but not previous layers - if we want separate lines per species we need to either specify this again *or* move the color aesthetic to the top layer. </span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>In the example above we may notice that we are assigning colour to the same variable (species) in both geometric layers. This means we have the option to simplify our code. Aesthetics set in the "top layer" of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> are inherited by all subsequent layers.</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co">### now colour is set here it will be inherited by ALL layers</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    <span class="co">#add another layer of data representation.</span>
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="try">
<p>
Note - that the trend line is blocking out certain points, because it is the ‘top layer’ of the plot. The geom layers that appear early in the command are drawn first, and can be obscured by the geom layers that come after them.
</p>
<p>
What happens if you switch the order of the geom_point() and geom_smooth() functions above? What do you notice about the trend line?
</p>
</div>
</div>
<div id="co-ordinate-space" class="section level3" number="6.4.4">
<h3>
<span class="header-section-number">6.4.4</span> Co-ordinate space<a class="anchor" aria-label="anchor" href="#co-ordinate-space"><i class="fas fa-link"></i></a>
</h3>
<p>ggplot will automatically pick the scale for each axis, and the type of coordinate space. Most plots are in Cartesian (linear X vs linear Y) coordinate space.</p>
<p>For this plot, let’s say we want the x and y origin to be set at 0. To do this we can add in <code><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim()</a></code> functions, which define the limits of the axes:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Set axis limits ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">240</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7000</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Further, we can control the coordinate space using <code>coord()</code> functions. Say we want to flip the x and y axes, we add <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip()</a></code>:</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">240</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7000</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="labels" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Labels<a class="anchor" aria-label="anchor" href="#labels"><i class="fas fa-link"></i></a>
</h2>
<p>By default, the axis labels will be the column names we gave as aesthetics aes(). We can change the axis labels using the xlab() and ylab() functions. Given that column names are often short and can be cryptic, this functionality is particularly important for effectively communicating results.</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Custom labels ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,
       y <span class="op">=</span> <span class="st">"Body mass (g)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;"></div>
<div id="titles-and-subtitles" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> Titles and subtitles<a class="anchor" aria-label="anchor" href="#titles-and-subtitles"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Add titles ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,
       y <span class="op">=</span> <span class="st">"Body mass (g)"</span>,
       title<span class="op">=</span> <span class="st">"Penguin Size, Palmer Station LTER"</span>,
       subtitle<span class="op">=</span> <span class="st">"Flipper length and body mass for three penguin species"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="themes" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Themes<a class="anchor" aria-label="anchor" href="#themes"><i class="fas fa-link"></i></a>
</h2>
<p>Finally, the overall appearance of the plot can be modified using theme() functions. The default theme has a grey background.
You may prefer <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code>, a <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal()</a></code> or even <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void()</a></code>. Try them out.</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Custom themes ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,
       y <span class="op">=</span> <span class="st">"Body mass (g)"</span>,
       title<span class="op">=</span> <span class="st">"Penguin Size, Palmer Station LTER"</span>,
       subtitle<span class="op">=</span> <span class="st">"Flipper length and body mass for three penguin species"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="info">
<p>
There is a lot more customisation available through the theme() function. We will look at making our own custom themes in later lessons
</p>
<p>
You can also try installing and running an even wider range of pre-built themes if you install the R package <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">ggthemes</a>.
</p>
<p>
First you will need to run the <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("ggthemes")</a></code> command. Remember this is one of the few times a command should NOT be written in your script but typed directly into the console. That's because it's rude to send someone a script that will install packages on their computer - think of <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> as a polite request instead!
</p>
<p>
To access the range of themes available type <code>help(ggthemes)</code> then follow the documentation to find out what you can do.
</p>
</div>
</div>
<div id="more-geom-shapes" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> More geom shapes<a class="anchor" aria-label="anchor" href="#more-geom-shapes"><i class="fas fa-link"></i></a>
</h2>
<div id="jitter" class="section level3" number="6.7.1">
<h3>
<span class="header-section-number">6.7.1</span> Jitter<a class="anchor" aria-label="anchor" href="#jitter"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> command adds some random scatter to the points which can reduce over-plotting. Compare these two plots:</p>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## geom point</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
              alpha <span class="op">=</span> <span class="fl">0.7</span>, 
              show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> 

<span class="co">## More geoms ----</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
              width <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># specifies the width, change this to change the range of scatter</span>
              alpha <span class="op">=</span> <span class="fl">0.7</span>, <span class="co"># specifies the amount of transparency in the points</span>
              show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># don't leave a legend in a plot, if it doesn't add value</span></code></pre></div>
</div>
<div id="boxplots" class="section level3" number="6.7.2">
<h3>
<span class="header-section-number">6.7.2</span> Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"><i class="fas fa-link"></i></a>
</h3>
<p>Box plots, or ‘box &amp; whisker plots’ are another essential tool for data analysis. Box plots summarize the distribution of a set of values by displaying the minimum and maximum values, the median (i.e. middle-ranked value), and the range of the middle 50% of values (inter-quartile range).
The whisker line extending above and below the IQR box define Q3 + (1.5 x IQR), and Q1 - (1.5 x IQR) respectively. You can watch a short video to learn more about box plots <a href="https://www.youtube.com/watch?v=fHLhBnmwUM0">here</a>.</p>
<div class="inline-figure"><img src="images/boxplot.png" width="80%" style="display: block; margin: auto;"></div>
<p>To create a box plot from our data we use (no prizes here) <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code></p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
              alpha <span class="op">=</span> <span class="fl">0.7</span>, 
              width <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># change width of boxplot</span>
              show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="try">
<p>
Note that when specifying colour variables using <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> some geometric shapes support an internal colour "fill" and an external colour "colour". Try changing the aes fill for colour in the code above, and note what happens.
</p>
</div>
<p>The points indicate outlier values [i.e., those greater than Q3 + (1.5 x IQR)].</p>
<p>We can overlay a boxplot on the scatter plot for the entire dataset, to fully communicate both the raw and summary data. Here we reduce the width of the jitter points slightly.</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, <span class="co"># note fill is "inside" colour and colour is "edges" - try it for yourself</span>
              alpha <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># fainter boxes so the points "pop"</span>
              width <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># change width of boxplot</span>
              outlier.shape<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,
                width<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="warning">
<p>
In the above example I switched from using show.legend=FALSE inside the geom layer to using theme(legend.position="none"). Why? This is an example of reducing redundant code. I would have to specify show.legend=FALSE for every geom layer in my plot, but the theme function applies to every layer. Save code, save time, reduce errors!
</p>
</div>
</div>
<div id="density-and-histogram" class="section level3" number="6.7.3">
<h3>
<span class="header-section-number">6.7.3</span> Density and histogram<a class="anchor" aria-label="anchor" href="#density-and-histogram"><i class="fas fa-link"></i></a>
</h3>
<p>Compare the following two sets of code:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">culmen_length_mm</span>, fill<span class="op">=</span><span class="va">species</span><span class="op">)</span>,
           position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">50</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-38-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>At first you might struggle to see/understand the difference between these two charts. The shapes should be roughly the same.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">culmen_length_mm</span>, fill<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">50</span>, 
                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>,
                   position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-39-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="webex-solution">
<button>
Explain this
</button>
<p>The first block of code produced a frequency histogram, each bar represents the actual number of observations made within each 'bin', the second block of code shows the 'relative density' within each bin. In a density histogram the area under the curve for each sub-group will sum to 1. This allows us to compare distributions and shapes between sub-groups of different sizes. For example there are far fewer Adelie penguins in our dataset, but in a density histogram they occupy the same area of the graph as the other two species.</p>
</div>
<p><br></p>
</div>
</div>
<div id="more-colours" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> More Colours<a class="anchor" aria-label="anchor" href="#more-colours"><i class="fas fa-link"></i></a>
</h2>
<p>There are two main differences when it comes to colors in <code>ggplot2</code>. Both arguments, color and fill, can be specified as single color or
assigned to variables.</p>
<p>As you have already seen in this tutorial, variables that are inside the aesthetics are encoded by variables and those that are outside are properties that are unrelated to the variables.</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">50</span>, 
                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span>,
                       fill<span class="op">=</span><span class="va">species</span><span class="op">)</span>, 
                   position <span class="op">=</span> <span class="st">"identity"</span>,
                   colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-41-1.png" width="100%" style="display: block; margin: auto;"></div>
<div id="choosing-and-using-colour-palettes" class="section level3" number="6.8.1">
<h3>
<span class="header-section-number">6.8.1</span> Choosing and using colour palettes<a class="anchor" aria-label="anchor" href="#choosing-and-using-colour-palettes"><i class="fas fa-link"></i></a>
</h3>
<p>You can specify what colours you want to assign to variables in a number of different ways.</p>
<p>In ggplot2, colors that are assigned to variables are modified via the scale_color_* and the scale_fill_* functions. In order to use color with your data, most importantly you need to know if you are dealing with a categorical or continuous variable. The color palette should be chosen depending on type of the variable:</p>
<ul>
<li><p><strong>sequential or diverging</strong> color palettes being used for continuous variables</p></li>
<li><p><strong>qualitative</strong> color palettes for (unordered) categorical variables:</p></li>
</ul>
<div class="inline-figure"><img src="images/palette.png" width="80%" style="display: block; margin: auto;"></div>
<p>You can pick your own sets of colours and assign them to a categorical variable. The number of specified colours <strong>has</strong> to match the number of categories. You can use a wide number of preset colour <a href="https://www.datanovia.com/en/blog/awesome-list-of-657-r-color-names/">names</a> or you can use <a href="https://www.datanovia.com/en/blog/awesome-list-of-hexadecimal-colors-you-should-have/">hexadecimals</a>.</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Custom colours ----</span>

<span class="va">penguin_colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>, <span class="st">"darkorchid3"</span>, <span class="st">"goldenrod1"</span><span class="op">)</span>

<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">penguin_colours</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>You can also use a range of inbuilt colour palettes:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="info">
<p>
You can explore all schemes available with the command <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">RColorBrewer::display.brewer.all()</a></code>
</p>
</div>
<p>There are also many, many extensions that provide additional colour palettes. Some of my favourite packages include <a href="https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html">ggsci</a> and <a href="https://github.com/karthik/wesanderson">wesanderson</a></p>
<div class="inline-figure"><img src="images/wesanderson.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="accessibility" class="section level2" number="6.9">
<h2>
<span class="header-section-number">6.9</span> Accessibility<a class="anchor" aria-label="anchor" href="#accessibility"><i class="fas fa-link"></i></a>
</h2>
<div id="colour-blindness" class="section level3" number="6.9.1">
<h3>
<span class="header-section-number">6.9.1</span> Colour blindness<a class="anchor" aria-label="anchor" href="#colour-blindness"><i class="fas fa-link"></i></a>
</h3>
<p>It's very easy to get carried away with colour palettes, but you should remember at all times that your figures must be accessible. One way to check how accessible your figures are is to use a colour blindness checker <a href="https://cran.r-project.org/web/packages/colorBlindness/vignettes/colorBlindness.html">colorBlindness</a></p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Check accessibility ----</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">colorBlindness</span><span class="op">)</span>
<span class="fu">colorBlindness</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/colorBlindness/man/cvdPlot.html">cvdPlot</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># will automatically run on the last plot you made</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="guides-to-visual-accessibility" class="section level3" number="6.9.2">
<h3>
<span class="header-section-number">6.9.2</span> Guides to visual accessibility<a class="anchor" aria-label="anchor" href="#guides-to-visual-accessibility"><i class="fas fa-link"></i></a>
</h3>
<p>Using colours to tell categories apart can be useful, but as we can see in the example above, you should choose carefully. Other aesthetics which you can access in your geoms include <code>shape</code>, and <code>size</code> - you can combine these in complimentary ways to enhance the accessibility of your plots. Here is a hierarchy of "interpretability" for different types of data</p>
<div class="inline-figure"><img src="images/list.png" width="80%" style="display: block; margin: auto;"></div>
<div class="inline-figure"><img src="images/shape_v_colour.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="facets" class="section level2" number="6.10">
<h2>
<span class="header-section-number">6.10</span> Facets<a class="anchor" aria-label="anchor" href="#facets"><i class="fas fa-link"></i></a>
</h2>
<p>Adding combinations of different aesthetics allows you to layer more information onto a 2D plot, sometimes though things will just become <em>too</em> busy. At the point where it becomes difficult to see the trends or differences in your plot then we want to break up a single plot into sub-plots; this is called ‘faceting’. Facets are commonly used when there is too much data to display clearly in a single plot. We will revisit faceting below, however for now, let’s try to facet the plot according to sex.</p>
<p>To do this we use the tilde symbol ‘~’ to indicate the column name that will form each facet.</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Facetting ----</span>
<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,    
              se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-50-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="patchwork" class="section level2" number="6.11">
<h2>
<span class="header-section-number">6.11</span> Patchwork<a class="anchor" aria-label="anchor" href="#patchwork"><i class="fas fa-link"></i></a>
</h2>
<p>There are many times you might want to <em>combine</em> separate figures into multi-panel plots. Probably the easiest way to do this is with the <code>patchwork</code> package (<span class="citation"><a href="references.html#ref-R-patchwork" role="doc-biblioref">Pedersen</a> (<a href="references.html#ref-R-patchwork" role="doc-biblioref">2020</a>)</span>).</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Patchwork ----</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">flipper_length_mm</span>, 
             y <span class="op">=</span> <span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">penguin_colours</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">culmen_depth_mm</span>, 
             y <span class="op">=</span> <span class="va">culmen_length_mm</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">penguin_colours</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span>     
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sex</span>,<span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
     <span class="fu">drop_na</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">species</span>, y<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span>, 
               width<span class="op">=</span><span class="fl">0.8</span>,
               position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span>, 
               alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span><span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange1"</span>, <span class="st">"azure4"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span>

 <span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span><span class="op">/</span><span class="va">p3</span><span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-51-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="activity-replicate-this-figure" class="section level2" number="6.12">
<h2>
<span class="header-section-number">6.12</span> Activity: Replicate this figure<a class="anchor" aria-label="anchor" href="#activity-replicate-this-figure"><i class="fas fa-link"></i></a>
</h2>
<div class="try">
<p>
How close can you get to replicating the figure below?
</p>
<p>
Make a NEW script for this assignment - replicate_figure.R
</p>
<p>
Make sure to use the tips and links at the end of this chapter, when you are done save the file and submit!
</p>
</div>
<div class="inline-figure"><img src="06-ggplot_files/figure-html/unnamed-chunk-53-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF8C00"</span>, <span class="st">"#A034F0"</span>, <span class="st">"#159090"</span><span class="op">)</span>

<span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>,
             y <span class="op">=</span> <span class="va">body_mass_g</span>,
             fill <span class="op">=</span> <span class="va">species</span>,
             colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>,
               alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"Body mass (g)"</span>,
    title <span class="op">=</span> <span class="st">"Body mass of brush-tailed penguins"</span>,
    subtitle <span class="op">=</span> <span class="st">"Box and violin plot of body mass by species"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="saving" class="section level2" number="6.13">
<h2>
<span class="header-section-number">6.13</span> Saving<a class="anchor" aria-label="anchor" href="#saving"><i class="fas fa-link"></i></a>
</h2>
<p>One of the easiest ways to save a figure you have made is with the <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> function. By default it will save the last plot you made on the screen.</p>
<p>You should specify the output path to your <strong>figures</strong> folder, then provide a file name. Here I have decided to call my plot <em>plot</em> (imaginative!) and I want to save it as a .PNG image file. I can also specify the resolution (dpi 300 is good enough for most computer screens).</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># OUTPUT FIGURE TO FILE</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"outputs/YYYYMMDD_ggplot_workshop_final_plot.png"</span>, dpi<span class="op">=</span><span class="fl">300</span><span class="op">)</span></code></pre></div>
<div class="try">
<p>
If you got this far and still have time why not try one of the following:
</p>
<ol style="list-style-type: decimal">
<li>
<p>
Making another type of figure using the penguins dataset, use the further reading below to use for inspiration.
</p>
</li>
<li>
<p>
Use any of your own data
</p>
</li>
</ol>
</div>
</div>
<div id="quitting-1" class="section level2" number="6.14">
<h2>
<span class="header-section-number">6.14</span> Quitting<a class="anchor" aria-label="anchor" href="#quitting-1"><i class="fas fa-link"></i></a>
</h2>
<div class="warning">
<p>
Make sure you have saved your script! Remember to Download your image file from RStudio Cloud onto YOUR computer.
</p>
</div>
<div class="info">
<p>
run <code>SessionInfo()</code> at the end of your script to gather the packages and versions you have been using. This is very useful for when you <a href="r-basics.html#how-to-cite-r-and-rstudio">cite R versions and packages</a> when writing reports later.
</p>
</div>
</div>
<div id="finished-2" class="section level2" number="6.15">
<h2>
<span class="header-section-number">6.15</span> Finished<a class="anchor" aria-label="anchor" href="#finished-2"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Make sure you have <strong>saved your scripts 💾</strong> in the <a href="#activity-1-organising-our-workspace">"scripts" folder</a>.</p></li>
<li><p>Make sure your workspace is set <strong>not</strong> to save objects from the environment <a href="r-basics.html#global-options"><em>between</em> sessions</a>.</p></li>
</ul>
<div id="what-we-learned" class="section level3" number="6.15.1">
<h3>
<span class="header-section-number">6.15.1</span> What we learned<a class="anchor" aria-label="anchor" href="#what-we-learned"><i class="fas fa-link"></i></a>
</h3>
<p>You have learned</p>
<ul>
<li><p>The anatomy of ggplots</p></li>
<li><p>How to add geoms on different layers</p></li>
<li><p>How to use colour, colour palettes, facets, labels and themes</p></li>
<li><p>Putting together multiple figures</p></li>
<li><p>How to save and export images</p></li>
</ul>
</div>
<div id="further-reading-guides-and-tips-on-data-visualisation" class="section level3" number="6.15.2">
<h3>
<span class="header-section-number">6.15.2</span> Further Reading, Guides and tips on data visualisation<a class="anchor" aria-label="anchor" href="#further-reading-guides-and-tips-on-data-visualisation"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><a href="https://www.rstudio.com/resources/cheatsheets/">R Cheat Sheets</a></p></li>
<li><p><a href="https://clauswilke.com/dataviz/">Fundamentals of Data Visualization</a>: this book tells you everything you need to know about presenting your figures for accessbility and clarity</p></li>
<li><p><a href="https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/">Beautiful Plotting in R</a>: an incredibly handy ggplot guide for how to build and improve your figures</p></li>
<li><p><a href="https://ggplot2-book.org/">The ggplot2 book</a>: the original Hadley Wickham book on ggplot2</p></li>
</ul>
</div>
</div>
</div>



<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    license
  );
});
</script><div class="chapter-nav">
<div class="prev"><a href="data-wrangling-part-two.html"><span class="header-section-number">5</span> Data wrangling part two</a></div>
<div class="next"><a href="markdown.html"><span class="header-section-number">7</span> Markdown</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-visualisation-with-ggplot2"><span class="header-section-number">6</span> Data visualisation with ggplot2</a></li>
<li><a class="nav-link" href="#intro-to-grammar"><span class="header-section-number">6.1</span> Intro to grammar</a></li>
<li>
<a class="nav-link" href="#before-we-start"><span class="header-section-number">6.2</span> Before we start</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#checklist-2"><span class="header-section-number">6.2.1</span> Checklist</a></li>
<li><a class="nav-link" href="#what-if-source-isnt-working"><span class="header-section-number">6.2.2</span> What if source isn't working?</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#building-a-plot"><span class="header-section-number">6.3</span> Building a plot</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#aesthetics---aes"><span class="header-section-number">6.3.1</span> Aesthetics - aes()</a></li></ul>
</li>
<li>
<a class="nav-link" href="#geometric-representations---geom"><span class="header-section-number">6.4</span> Geometric representations - geom()</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#and"><span class="header-section-number">6.4.1</span> %&gt;% and +</a></li>
<li><a class="nav-link" href="#colour"><span class="header-section-number">6.4.2</span> Colour</a></li>
<li><a class="nav-link" href="#more-layers"><span class="header-section-number">6.4.3</span> More layers</a></li>
<li><a class="nav-link" href="#co-ordinate-space"><span class="header-section-number">6.4.4</span> Co-ordinate space</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#labels"><span class="header-section-number">6.5</span> Labels</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#titles-and-subtitles"><span class="header-section-number">6.5.1</span> Titles and subtitles</a></li></ul>
</li>
<li><a class="nav-link" href="#themes"><span class="header-section-number">6.6</span> Themes</a></li>
<li>
<a class="nav-link" href="#more-geom-shapes"><span class="header-section-number">6.7</span> More geom shapes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#jitter"><span class="header-section-number">6.7.1</span> Jitter</a></li>
<li><a class="nav-link" href="#boxplots"><span class="header-section-number">6.7.2</span> Boxplots</a></li>
<li><a class="nav-link" href="#density-and-histogram"><span class="header-section-number">6.7.3</span> Density and histogram</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#more-colours"><span class="header-section-number">6.8</span> More Colours</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#choosing-and-using-colour-palettes"><span class="header-section-number">6.8.1</span> Choosing and using colour palettes</a></li></ul>
</li>
<li>
<a class="nav-link" href="#accessibility"><span class="header-section-number">6.9</span> Accessibility</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#colour-blindness"><span class="header-section-number">6.9.1</span> Colour blindness</a></li>
<li><a class="nav-link" href="#guides-to-visual-accessibility"><span class="header-section-number">6.9.2</span> Guides to visual accessibility</a></li>
</ul>
</li>
<li><a class="nav-link" href="#facets"><span class="header-section-number">6.10</span> Facets</a></li>
<li><a class="nav-link" href="#patchwork"><span class="header-section-number">6.11</span> Patchwork</a></li>
<li><a class="nav-link" href="#activity-replicate-this-figure"><span class="header-section-number">6.12</span> Activity: Replicate this figure</a></li>
<li><a class="nav-link" href="#saving"><span class="header-section-number">6.13</span> Saving</a></li>
<li><a class="nav-link" href="#quitting-1"><span class="header-section-number">6.14</span> Quitting</a></li>
<li>
<a class="nav-link" href="#finished-2"><span class="header-section-number">6.15</span> Finished</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-we-learned"><span class="header-section-number">6.15.1</span> What we learned</a></li>
<li><a class="nav-link" href="#further-reading-guides-and-tips-on-data-visualisation"><span class="header-section-number">6.15.2</span> Further Reading, Guides and tips on data visualisation</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/UEABIO/data-sci-v1/blob/main/book/06-ggplot.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/UEABIO/data-sci-v1/edit/main/book/06-ggplot.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>5023Y</strong>: Data Science for Biologists" was written by Philip T. Leftwich. It was last built on 2022-11-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
